<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Taste Explorer ‚Äì Feedback</title>

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&display=swap"
    />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <style>
      body {
        font-family: "Plus Jakarta Sans", sans-serif;
      }

      /* ‚ú® Feedback card */
      .feedback-item {
        background: #fff;
        border: 1px solid #f1e9ea;
        border-radius: 12px;
        padding: 16px 20px;
        margin-bottom: 12px;
        transition: all 0.2s ease;
      }

      .feedback-item:hover {
        background: #fff8f8;
        transform: translateY(-2px);
      }

      /* ü™Ñ Toast animation */
      @keyframes fadeInOut {
        0% {
          opacity: 0;
          transform: translateY(10px);
        }
        10% {
          opacity: 1;
          transform: translateY(0);
        }
        90% {
          opacity: 1;
          transform: translateY(0);
        }
        100% {
          opacity: 0;
          transform: translateY(10px);
        }
      }

      #toast {
        animation: fadeInOut 3s ease forwards;
      }
    </style>
  </head>

  <body class="bg-[#fbf9f9] text-[#191010]">
    <!-- üåê Header -->
    <header
      class="flex items-center justify-between border-b border-[#f1e9ea] px-8 py-4 sticky top-0 bg-white/80 backdrop-blur-md z-50"
    >
      <div class="flex items-center gap-3">
        <svg
          class="w-6 h-6 text-[#e63946]"
          viewBox="0 0 48 48"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M24 4H42V17.3333V30.6667H24V44H6V30.6667V17.3333H24V4Z"
            fill="currentColor"
          ></path>
        </svg>
        <h1 class="font-extrabold text-lg tracking-tight">Taste Explorer</h1>
      </div>

      <nav class="flex gap-6 text-sm font-medium">
        <a href="./home.html" class="hover:text-[#e63946]">Home</a>
        <a href="./recipe.html" class="hover:text-[#e63946]">Recipes</a>
        <a href="./feedback.html" class="text-[#e63946] font-semibold"
          >Feedback</a
        >
      </nav>
    </header>

    <!-- üìù Feedback form -->
    <main class="max-w-3xl mx-auto p-6">
      <section class="mb-8">
        <h2 class="text-2xl font-bold mb-2">Feedback & Support</h2>
        <p class="text-[#8b5b5c] text-sm mb-4">
          We value your thoughts! Share feedback to help us improve your
          experience.
        </p>

        <div class="flex flex-col gap-3">
          <textarea
            id="feedback-input"
            placeholder="Enter your comments or suggestions here..."
            class="rounded-xl border border-[#e3d4d4] bg-[#fffafc] focus:ring-2 focus:ring-[#e8b5b7] focus:outline-none p-4 text-sm resize-none h-36"
          ></textarea>

          <button
            id="submit-btn"
            class="self-end bg-[#e8b5b7] hover:bg-[#e49ba0] text-[#191010] font-bold py-2 px-5 rounded-xl transition active:scale-95"
            onclick="submitFeedback()"
          >
            Submit Feedback
          </button>
        </div>
      </section>

      <!-- üí¨ All Feedback Section -->
      <section>
        <h2 class="text-xl font-bold mb-3">All Feedback</h2>
        <div id="feedback-list" class="min-h-[100px] space-y-3">
          <p class="text-sm text-gray-400 italic">Loading feedback...</p>
        </div>
      </section>

      <!-- üìû Contact Info -->
      <section class="mt-10 border-t border-[#f1e9ea] pt-6">
        <h2 class="text-xl font-bold mb-3">Contact Information</h2>
        <p class="text-sm text-[#8b5b5c] mb-3">
          Our support team is available Monday to Friday, 9 AM to 6 PM (EST).
        </p>
        <div class="grid grid-cols-2 gap-y-2 text-sm">
          <div>Email:</div>
          <div class="font-medium">support@recipeexplorer.com</div>
          <div>Phone:</div>
          <div class="font-medium">+1 (555) 123-4567</div>
        </div>
      </section>
    </main>

    <!-- üåü Toast Notification -->
    <div
      id="toast"
      class="hidden fixed bottom-6 right-6 bg-[#e8b5b7] text-[#191010] px-5 py-3 rounded-xl shadow-md text-sm font-medium"
    ></div>

    <footer
      class="text-center text-sm text-gray-500 py-5 border-t border-[#f1e9ea] mt-10"
    >
      ¬© 2025 Taste Explorer | Built with ‚ù§Ô∏è by Janhavi Vyas
    </footer>

    <script>
      // üåü Show toast
      function showToast(message) {
        const toast = document.getElementById("toast");
        toast.textContent = message;
        toast.classList.remove("hidden");
        setTimeout(() => toast.classList.add("hidden"), 3000);
      }

      // üß† Load feedback
      async function loadFeedback() {
        const container = document.getElementById("feedback-list");
        container.innerHTML =
          '<p class="text-sm text-gray-400 italic">Loading feedback...</p>';

        try {
          const res = await fetch("http://localhost:3000/api/feedback");
          const feedbacks = await res.json();

          if (!feedbacks.length) {
            container.innerHTML =
              '<p class="text-gray-400 italic text-sm">No feedback yet. Be the first to share!</p>';
            return;
          }

          container.innerHTML = feedbacks
            .map(
              (f) => `
          <div class="feedback-item">
            <p class="message text-sm">${f.message}</p>
            <small class="date text-xs text-[#8b5b5c]">${
              new Date(f.createdAt).toLocaleString()
            }</small>
          </div>`
            )
            .join("");
        } catch (err) {
          console.error("Error loading feedback:", err);
          container.innerHTML =
            '<p class="text-red-500 text-sm">Failed to load feedback.</p>';
        }
      }

      // ‚úçÔ∏è Submit feedback
      async function submitFeedback() {
        const textarea = document.getElementById("feedback-input");
        const message = textarea.value.trim();

        if (!message) {
          showToast("Please enter your feedback!");
          return;
        }

        try {
          const res = await fetch("http://localhost:3000/api/feedback", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message }),
          });

          if (!res.ok) throw new Error("Failed to submit feedback");

          textarea.value = "";
          await loadFeedback();
          showToast("üéâ Feedback submitted successfully!");
        } catch (err) {
          console.error("Error submitting feedback:", err);
          showToast("‚ùå Something went wrong!");
        }
      }

      document.addEventListener("DOMContentLoaded", loadFeedback);
    </script>
  </body>
</html>
